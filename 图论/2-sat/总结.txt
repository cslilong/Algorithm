【pku 2749 】

--author: Answeror

---title: [PKU][2749][Building roads]

----link: http://acm.pku.edu.cn/JudgeOnline/problem?id=2749

----date: 2009-08-04

-problem: 二维整数坐标上有n个普通点, 2个中转点, 现在要求每个普通点都要连到一个中转点, 两个中转点之间也相连, 有a对普通点不能连在同一个中转点, 有b对普通点必须连在同一个中转点, 求一种分配方案, 使各普通点间路径长度最大值最小. 所有连接都是曼哈顿路, 即平行于x轴或y轴.

solution: 2-SAT, 二分, 并查集, 预处理

 

本题合取式如下(x[i]表示i连1号中转点, ~x[i]表示i连2号中转点):

hate:   (x[i]∪x[j])∩(~x[i]∪~x[j])

friend: (x[i]∪~x[j])∩(~x[i]∪x[j])

然后跟2723类似, 二分答案, 加上两点间最长距离限制, 不满足此限制的有如下合取式(not(x[i], x[j])表示i连1号中转站, j连1号中转站的情况下会超过长度限制, 其它类同):

not(x[i], x[j]):   (~x[i]∪~x[j])

not(~x[i], ~x[j]): (x[i]∪x[j])

not(~x[i], x[j]):  (x[i]∪~x[j])

not(x[i], ~x[j]):  (~x[i]∪x[j])

建图, 套模板.

 

这题时间卡得比较紧, 有两个优化:

1. 先用friend-enemy并查集判断矛盾, 若矛盾直接输出-1.

2. 先开一个d[N][N][2][2]的数组预处理i连x号中转点并且j连y号中转点时的i,j路径长度, 不要每次二分都重新计算.

标程用的算法是二分查找，给定一个答案后，用2-SAT判断是否可行。下面主要说一下2-SAT问题的建模。用布尔变量Xi表示第i个牛栏连到第一个中转站，即Xi为真时连到第一个，为假时连到第二个。那么~Xi表示第i个牛栏连到第二个中转站，~表示布尔取反。 检查每一个约束条件，构造2-SAT的和取范式。 

1）i和j不连到同一个中转站，就增加和取范式(Xi + Xj)(~Xi + ~Xj)。

2）i和j必须连到同一个中转站，就增加和取范式(Xi + ~Xj)(~Xi + Xj)。 

设现在二分的答案是S。那么检查每一对牛栏i和j（假设D1i，D1j表示i和j到第一个中转站的距离，D2i，D2j表示i和j到第二个中转站的距离，DD表示两个中转站之间的距离）。如果 

3）D1i + D1j 〉S，就增加和取范式（~Xi + ~Xj） 

4）D2i + D2j 〉S，就增加和取范式（Xi + Xj） 

5）D1i + D2j + DD 〉S，就增加和取范式（~Xi + Xj） 

6）D2i + D1j + DD 〉S，就增加和取范式（Xi + ~Xj） 

剩下的只是用2-SAT的现成算法去判断是否有解。



【pku 3207 】
题目原来的叙述不太好理解, 换个说法. 一个圆盘的边沿上有n个点, 下标从0开始, 有m条
线连接2m个互不相同的点, 线可以从圆盘任意一面过, 要求任意两条线不能相交. 给出m条
线(正反面随意), 问是否存在一种给每条线的正反面的分配方法, 使满足要求.
 

这题是2-SAT(2判定性问题(http://en.wikipedia.org/wiki/2-satisfiability))的基础题,
关键在于建图.
 

令第i条线(i从0开始)在正面为第2i个顶点, 在反面为第2i+1个顶点. 若第i条线和第j条线
构成一个四边形的两条对角线, 则在2i和2j+1之间连一条双向边, 2i+1和2j之间连一条双向
边. 这样建图后求强连通分量, 看点2i和点2i+1是否在同一个强连通分量中, 只要有, 就说
明不满足要求, 如果没有则满足.
 

这里对建图的方式做一点解释. 首先, 我们知道若第i条线和第j条线构成一个四边形的两条
对角线, 则2i和2j不相容, 又2i和2i+1中必须出现一个, 且2j和2j+1中必须出现一个, 所以
可以说2i+1和2j+1中至少出现一个, 这就是2-SAT的合取式中的"或"的来路. 换句话说, 从
2i到2j+1连一条有向边表示如果选择了2i就必须选择2j+1, 从2j到2i+1连一条有向边表示如
果选择了2j就必须选择2i+1, 同理对于2i+1和2j+1的不相容也可以连两条有向边, 所以最后
跟上面的组成了两条双向边.



【pku 2723】
---title: [PKU][2723][Get Luffy Out]
----link: http://acm.pku.edu.cn/JudgeOnline/problem?id=2723
-problem: 有m道门, 开了前一道才能开后一道, 每道门上两把锁, 开一把就能开门, 这些锁并不是完全不同. 有2n把不同的钥匙, 每把对应一种锁, 这些钥匙被分成n对, 每对钥匙只能取其中的一把, 取其中一把, 另一把就会消失, 问最多能开几道门.

solution: 2-SAT, 二分
直接解并不容易, 但是容易注意到, 
若最优解能开x道门, 那么就肯定能开y道门(y<=x), 这样问题的解就具有单调性, 可以二分答案然后判断是否存在矛盾. 

按照2-SAT标准步骤, 把每把钥匙对应到图中的两个顶点, 分别表示取和不取,
 还是老样子, 理解了(┐avb)与(a->b)的等价关系就不难, 用文字描述也就是要满足以下几个逻辑式(假设要开k道门):
1. 前k道门, 每道门上的锁至少要打开一把.
2. 每对钥匙中至少要有一把不取. (听起来有点别扭)
还有第三条, 是可加可不加的: 每对钥匙中至少取一把. 这个逻辑式存在与否并不会影响最终结果.
知道怎么建图之后就是二分答案, 每次重新建图, 套模板, 判矛盾.
这题WA了好几次, 因为二分的上界少了1. 注意做测试数据的时候尽量取极端数据, 这里就是取门全开的情况排错.

【pku3648 】
--author: Answeror
---title: [PKU][3648][Wedding]
----link: http://acm.pku.edu.cn/JudgeOnline/problem?id=3648

-problem: 有n男n女, 其中一对是新人, 其他n-1对是夫妻, 现在有一张长桌两边坐人(题目没有要求两边人一样多), 要求新郎新娘不在同一边, 每对夫妻不在同一边. 另外, n对人中有m对有奸情(有可能是同性恋, 有可能是新郎或新娘), 要求有奸情的两个人不能都坐在新娘对面, 若能安排座位, 则输出跟新娘在一边的人, 否则输出"bad luck".
solution: 2-SAT
这题首先要看清题目, 并不是说有奸情的两个人一定不能坐在同一边("it is bad luck for the bride to see both members of such a pair"), 新郎新娘不在同一边("The bride and groom sit at one end, opposite each other"), 又因为每对夫妻不在同一边, 所以两边人数相等.

然后构图, 设座位分左边和右边, 顶点2i表示i号男人坐左边, 2i+1表示i号男人坐右边, 顶点2i+2n表示i号女人坐左边, 2i+1+2n表示i号女人坐右边. 每对都不在同一边好办, 每对连4条有向边即可, 但是奸情的要求怎么表示呢? 通奸的两个人可以在新娘同一边, 也可以其中一个在新娘对面, 无法用X∪Y来表示. 

不妨设新娘在左边, 那么通奸的两人其中一个在右边的话, 另一个必然在左边. 嗯, 这样一来通奸的要求搞定了, 那么如何把新娘一定在左边表示在有向图中呢?
那么换个说法, 因为新郎一定在右边, 所以如果新娘在右边, 那么新郎也一定在右边, 并且如果新郎在左边, 新娘也一定在左边, 又已经有要求新郎新娘不在同一边, 所以只要再加上上述两条有向边即可保证新娘一定在左边. 

接下来就是套模板的事情了.


【PKU 3678 Katu Puzzle】 
经典2-sat验证题。
假设a为1,则!a为0。建图转换：
a and b = 1    转换为 ：(!a -> a),(!b->b)，因为a，b必选，!a -> a这样会导致a一定被选，为什么？想想构造一组解的时候，经过求强连通分量和缩点后，对新图进行拓扑排序，然后按拓扑倒序对点进行染色。现在明白了吧！因为存在!a->a，所以呢染色的顺序一定是a ,!a，这时如果a没被染色，那么a就一定被染红色，则！a一定被染蓝色（看赵爽的论文）。如果a与!a之间不存在边的关系呢，则表示a,!a任选一个，因为其中一个被染红色，则另外一个一定被染蓝色，具体你的程序选择哪个，就看你的拓扑部分是怎么写的（点的访问顺序）。

a and b = 1    转换为 ：(!a -> a),(!b->b)
a and b = 0 转换为：(a->!b),(b->!a)
a or b = 1    转换为：(!a->b),(!b->a)
a or b = 0   转换为：(a->!a),(b->!b)
a xor b = 1   转换为：(a->!b),(!b->a),(b->!a),(!a->b)
a xor b = 0   转换为：(a->b),(b->a),(!a->!b),(!b->!a)


【PKU 3683】
2-sat验证+输出一组解
【题目大意】：有N个区间（A,B），和一个值C。你可以选择使用（A,A+C）或（B-C,B）中一个区间，使得所有选择出来的N个区间不相交，求方案。

设a表示选择Si to Si + Di，则!a表示选择Ti - Di to Ti
建图则有：
若s[a]与s[b]有交点，则(a,!b),(b,!a)
若s[a]与t[b]有交点，则(a,b),(!b,!a)
若t[a]与s[b]有交点，则(!a,!b),(b,a)
若t[a]与t[b]有交点，则(!a,b),(!b,a)


